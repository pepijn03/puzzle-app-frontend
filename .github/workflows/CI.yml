name: Angular Build

# {1}
on:
  pull_request:
    branches: [ "main" ]

jobs:
  angular:
    name: Angular Build
    runs-on: ubuntu-latest
    strategy:
      matrix:
        node-version: [20]
        # See supported Node.js release schedule at https://nodejs.org/en/about/releases/
    steps:
    
    - name: Checkout Repository
      uses: actions/checkout@v2

    - name: Adding Node.js
      uses: actions/setup-node@v2
      with:
        node-version: 20
        
    - name: Install Dependencies
      run: npm install

    - name: Build Angular App
      run: npm run build

  push-image-to-dockerhub:
        runs-on: ubuntu-latest
    
        steps:
          -
            name: Checkout
            uses: actions/checkout@v3
          -
            name: Set env
            run: echo "RELEASE_VERSION=${GITHUB_REF#refs/*/}" >> $GITHUB_ENV
          -
            name: Login to Docker Hub
            uses: docker/login-action@v2
            with:
              username: ${{ secrets.DOCKER_USERNAME }}
              password: ${{ secrets.DOCKER_PASSWORD }}
          -
            name: Set up Docker Buildx
            uses: docker/setup-buildx-action@v2
            with:
              version: v0.7.0
          -
            name: Build and push
            uses: docker/build-push-action@v3
            with:
              file: ./Dockerfile
              push: true
              tags: pepijn03/puzzle-app-frontend:latest
